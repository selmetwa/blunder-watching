(()=>{"use strict";var e={283:(e,t,r)=>{r.d(t,{Sw:()=>n,T7:()=>s,hO:()=>a,sh:()=>l,zi:()=>o});const s=["a1","b1","c1","d1","e1","f1","g1","h1","a2","b2","c2","d2","e2","f2","g2","h2","a3","b3","c3","d3","e3","f3","g3","h3","a4","b4","c4","d4","e4","f4","g4","h4","a5","b5","c5","d5","e5","f5","g5","h5","a6","b6","c6","d6","e6","f6","g6","h6","a7","b7","c7","d7","e7","f7","g7","h7","a8","b8","c8","d8","e8","f8","g8","h8"],n=["bk","bq","br","bb","bn","bp","wk","wq","wr","wb","wn","wp"],o={e:0,p:1,n:3,b:3,r:5,q:9,k:10},l={1:"a",2:"b",3:"c",4:"d",5:"e",6:"f",7:"g",8:"h"},a={a:1,b:2,c:3,d:4,e:5,f:6,g:7,h:8}},497:(e,t,r)=>{r.d(t,{s:()=>o});var s=r(283),n=r(253);const o=e=>{const[t,r]=e&&e.square&&e?.square?.split("")||[],o=(0,n.c)(e.attackers.length,e.defenders.length),l=document.createElement("div");l.style.backgroundSize="100%",l.style.cursor="pointer",l.style.cursor="grab",l.style.cursor="-webkit-grab",l.style.height="12.5%",l.style.left="0",l.style.overflow="hidden",l.style.position="absolute",l.style.top="0",l.style.touchAction="none",l.style.width="12.5%",l.style.willChange="transform",l.style.outline="1px solid black",l.style.backgroundColor=o||"",l.classList.add("empty"),l.classList.add(`square-${s.hO[t]}${r}`);const a=document.createElement("div");a.classList.add("attackers-defenders"),a.style.padding="2px";const c=document.createElement("p");c.style.fontSize="12px",c.innerText=""+(e.defenders.length-e.attackers.length),a.appendChild(c),l.appendChild(a);const i=document.createElement("div");i.classList.add("target");const d=document.createElement("p");return d.textContent=`${e.square}`,d.style.fontSize="11px",i.style.position="absolute",i.style.bottom="0",i.style.right="0",i.style.padding="2px",i.appendChild(d),l.appendChild(i),l}},17:(e,t,r)=>{r.d(t,{q:()=>s});const s=(e,t)=>{const r=document.createElement("div"),s=document.createElement("p");r.classList.add("target"),r.style.fontSize="12px",r.style.position="absolute",r.style.top="0",r.style.right="0",r.style.padding="2px";const n=e===t.winner?"+":"-";return s.innerText=`${n}${t.diff}`,r.appendChild(s),r}},319:(e,t,r)=>{r.d(t,{U:()=>s});const s=()=>{const e=document.createElement("div"),t=document.createElement("i");return t.style.color="black",t.style.zIndex="1000",t.style.fontSize="12px",t.style.padding="4px",e.style.position="absolute",e.style.top="0",e.style.right="0",t.className="fa-solid fa-crosshairs",e.classList.add("target"),e.appendChild(t),e}},746:(e,t,r)=>{r.d(t,{U:()=>s});const s=e=>{const t=document.createElement("div");t.classList.add("target");const r=document.createElement("p");return r.textContent=`${e.square}`,r.style.fontSize="11px",t.style.position="absolute",t.style.bottom="0",t.style.right="0",t.style.padding="2px",t.appendChild(r),t}},253:(e,t,r)=>{r.d(t,{c:()=>s});const s=(e,t)=>e===t?"rgba(201, 240, 255, 1)":e>t?["rgba(197, 150, 151, 1)","rgba(190, 137, 137, 1)","rgba(183, 123, 123, 1)","rgba(175, 110, 110, 1)","rgba(168, 97, 97, 1)","rgba(158, 87, 87, 1)","rgba(151, 74, 74, 1)","rgba(144, 61, 61, 1)"][e-t-1]:t>e?["rgba(151, 196, 175, 1)","rgba(129, 177, 158, 1)","rgba(108, 158, 141, 1)","rgba(86, 139, 124, 1)","rgba(65, 120, 107, 1)","rgba(43, 101, 90, 1)","rgba(22, 82, 73, 1)","rgba(0, 63, 56, 1)"][t-e-1]:void 0},458:(e,t,r)=>{r.d(t,{B:()=>s});const s=(e,t)=>{let r="";for(let s=0;s<Math.min(e.length,t.length);s++)e[s]!==t[s]&&(r+=t[s]);return r}},96:(e,t,r)=>{r.d(t,{r:()=>i});var s=r(62),n=r(136),o=r(301),l=r(664),a=r(533),c=r(709);const i=(e,t)=>{const r=[];for(let i=0;i<8;i++)for(let d=0;d<8;d++){const f=e[i][d];if(f){if("p"===f.type){const n=(0,s.x)(e,f,t);n&&r.push(n)}if("n"===f.type){const s=(0,n.f)(e,f,t);s&&r.push(s)}if("b"===f.type){const s=(0,o.E)(e,f,t);s&&r.push(s)}if("r"===f.type){const s=(0,l.M)(e,f,t);s&&r.push(s)}if("q"===f.type){const s=(0,a.$)(e,f,t);s&&r.push(s)}if("k"===f.type){const s=(0,c.O)(e,f,t);s&&r.push(s)}}}return{attackers:r}}},144:(e,t,r)=>{r.d(t,{d:()=>o});var s=r(283),n=r(96);const o=(e,t)=>{const r=Array.from(e).map((e=>{const t=e.classList,r=Object.values(t),n=r.find((e=>s.Sw.includes(e))),o=r.find((e=>e.startsWith("square-"))),l=o?.split("-")[1],a=n?.charAt(0),c=n?.charAt(1),i=Number(l?.charAt(0)),d=l?.charAt(1);return{color:a,type:c,square:`${s.sh[i]}${d}`,attackers:[],defenders:[],value:s.zi[c??"e"]}})),o=r.map((e=>e.square)),l=s.T7.filter((e=>!o.includes(e))).map((e=>({color:null,type:"e",square:e,attackers:[],defenders:[],value:0}))),a=[...r,...l],c=Array.from({length:8},(()=>Array(8).fill(null)));a.forEach((e=>{const{color:t,type:r,square:s,attackers:n,defenders:o,value:l}=e,[a,i]=s.split(""),d=a.charCodeAt(0)-97,f=parseInt(i)-1;void 0!==c?.[f]?.[d]&&(c[f][d]={color:t,type:r,square:s,attackers:n,defenders:o,value:l})}));for(let e=0;e<8;e++)for(let r=0;r<8;r++){const s=c[e][r],{attackers:o}=(0,n.r)(c,s);if(void 0!==c?.[e]?.[r])if("white"===t){if("w"===s.color){const t=o.filter((e=>"w"===e.color)),s=o.filter((e=>"b"===e.color));c[e][r].attackers=s,c[e][r].defenders=t}if("b"===s.color){const t=o.filter((e=>"w"===e.color)),s=o.filter((e=>"b"===e.color));c[e][r].attackers=s,c[e][r].defenders=t}if(null===s.color){const t=o.filter((e=>"w"===e.color)),s=o.filter((e=>"b"===e.color));c[e][r].attackers=s,c[e][r].defenders=t}}else{if("w"===s.color){const t=o.filter((e=>"b"===e.color)),s=o.filter((e=>"w"===e.color));c[e][r].attackers=s,c[e][r].defenders=t}if("b"===s.color){const t=o.filter((e=>"b"===e.color)),s=o.filter((e=>"w"===e.color));c[e][r].attackers=s,c[e][r].defenders=t}if(null===s.color){const t=o.filter((e=>"b"===e.color)),s=o.filter((e=>"w"===e.color));c[e][r].attackers=s,c[e][r].defenders=t}}}return c}},301:(e,t,r)=>{r.d(t,{E:()=>n});var s=r(740);const n=(e,t,r)=>{const{row:n,col:o}=(0,s.x)(e,t),{row:l,col:a}=(0,s.x)(e,r);if(n===l&&o===a)return null;const c=Math.abs(n-l);if(c===Math.abs(o-a)){const r=l>n?1:-1,s=a>o?1:-1;for(let t=1;t<c;t++){const l=o+t*s;if(null!==e[n+t*r][l].color)return null}return t}return null}},740:(e,t,r)=>{r.d(t,{x:()=>s});const s=(e,t)=>{for(let r=0;r<e.length;r++)for(let s=0;s<e[r].length;s++)if(e[r][s]===t)return{row:r,col:s};return{row:-1,col:-1}}},709:(e,t,r)=>{r.d(t,{O:()=>n});var s=r(740);const n=(e,t,r)=>{const{row:n,col:o}=(0,s.x)(e,t),{row:l,col:a}=(0,s.x)(e,r);if(n===l&&o===a)return null;const c=Math.abs(n-l),i=Math.abs(o-a);return 1===c&&0===i||0===c&&1===i||1===c&&1===i?t:null}},136:(e,t,r)=>{r.d(t,{f:()=>s});const s=(e,t,r)=>{const[s,n]=t.square.split(""),o=s?.charCodeAt(0)-97,l=parseInt(n)-1,a=[[l+2,o+1],[l+2,o-1],[l-2,o+1],[l-2,o-1],[l+1,o+2],[l+1,o-2],[l-1,o+2],[l-1,o-2]];for(let s=0;s<a.length;s++){const[n,o]=a[s];if(n>=0&&n<8&&o>=0&&o<8&&e[n][o].square===r.square)return t}return null}},62:(e,t,r)=>{r.d(t,{x:()=>s});const s=(e,t,r)=>{if("w"===t.color&&"p"===t.type){const[s,n]=t.square.split(""),o=s.charCodeAt(0)-97,l=parseInt(n)-1;if(o>0){const s=e[l+1][o-1];if(r.square===s.square)return t}if(o<7){const s=e[l+1][o+1];if(r.square===s.square)return t}}if("b"===t.color&&"p"===t.type){const[s,n]=t.square.split(""),o=s.charCodeAt(0)-97,l=parseInt(n)-1;if(o>0){const s=e[l-1][o-1];if(r.square===s.square)return t}if(o<7){const s=e[l-1][o+1];if(r.square===s.square)return t}}return null}},533:(e,t,r)=>{r.d(t,{$:()=>n});var s=r(740);const n=(e,t,r)=>{const{row:n,col:o}=(0,s.x)(e,t),{row:l,col:a}=(0,s.x)(e,r);if(n===l&&o===a)return null;const c=Math.abs(n-l),i=Math.abs(o-a);if(n===l||o===a||c===i){const r=n!==l,s=c===i,d=r||s?l>n?1:-1:a>o?1:-1;for(let t=1;r&&n+t*d!==l||!r&&!s&&o+t*d!==a;t++){const l=r?s?o+t*d:o:o+t*d,a=e[r||s?n+t*d:n][l];if(null!==a?.color)return null}return t}return null}},664:(e,t,r)=>{r.d(t,{M:()=>n});var s=r(740);const n=(e,t,r)=>{const{row:n,col:o}=(0,s.x)(e,t),{row:l,col:a}=(0,s.x)(e,r);if(n===l&&o===a)return null;if(n===l||o===a){const r=n!==l,s=r?l>n?1:-1:a>o?1:-1;for(let t=1;r?n+t*s!==l:o+t*s!==a;t++){const l=r?o:o+t*s,a=e[r?n+t*s:n][l];if(null!==a?.color)return null}return t}return null}},957:(e,t,r)=>{r.d(t,{B:()=>s,O:()=>n});const s=e=>{let t=[...e.defenders].sort(((e,t)=>e.value-t.value))??[],r=[...e.attackers].sort(((e,t)=>e.value-t.value))??[];r.unshift(e);let s=0,n=0;for(;t.length>0&&r.length>0;)n+=r.shift()?.value??0,r.length>0&&(s+=t.shift()?.value??0);return n>s?{winner:"white",diff:n-s}:n<s?{winner:"black",diff:s-n}:{winner:"null",diff:0}},n=e=>{let t=[...e.defenders].sort(((e,t)=>e.value-t.value))??[],r=[...e.attackers].sort(((e,t)=>e.value-t.value))??[];r.unshift(e);let s=0,n=0;for(;t.length>0&&r.length>0;)n+=r.shift()?.value??0,r.length>0&&(s+=t.shift()?.value??0);return n>s?{winner:"black",diff:n-s}:n<s?{winner:"white",diff:s-n}:{winner:"null",diff:0}}}},t={};function r(s){var n=t[s];if(void 0!==n)return n.exports;var o=t[s]={exports:{}};return e[s](o,o.exports,r),o.exports}r.d=(e,t)=>{for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e=r(144),t=r(283),s=r(253),n=r(458),o=r(957),l=r(497),a=r(319),c=r(746),i=r(17);let d="white";const f=document.createElement("link");f.href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css",f.rel="stylesheet",document.head.appendChild(f),chrome.runtime.onMessage.addListener(((e,t,r)=>{if("selectedOption"===e.action){const t=e.value;r({status:"Option received"}),d=t,h()}}));const u=document.querySelector("wc-chess-board");let p="";function h(r=""){const n=u&&u.childNodes;if(!n)return;const f=Array.from(n).filter((e=>e.nodeType===Node.ELEMENT_NODE&&e.classList.contains("piece")));Array.from(n).filter((e=>e.nodeType===Node.ELEMENT_NODE&&e.classList.contains("empty"))).forEach((e=>{u.removeChild(e)}));const h=f.map((e=>{const t=e;return`${t.classList[1]}_${t.classList[2]}`})).join("_");p=h;const b=(0,e.d)(f,d).flat();for(const e of b){const[r,n]=e&&e.square&&e?.square?.split("")||[],f=`.square-${t.hO[r]}${n}`,p=document.querySelectorAll(f);if("e"===e.type){const t=(0,l.s)(e);u.appendChild(t)}p.forEach((t=>{const r=t?.querySelectorAll(".attackers-defenders"),n=t?.querySelectorAll(".target");if(r?.forEach((e=>{t?.removeChild(e)})),n?.forEach((e=>{t?.removeChild(e)})),t){const r=t,n=(0,s.c)(e.attackers.length,e.defenders.length);let l={winner:"null",diff:0};"white"===d&&"b"===e.color&&e.defenders.length>0&&e.attackers.length>0&&(l=(0,o.B)(e)),"black"===d&&"w"===e.color&&e.defenders.length>0&&e.attackers.length>0&&(l=(0,o.O)(e));let f=!1;f="white"===d?"w"===e.color?0===e.defenders.length:0===e.attackers.length:"b"===e.color?0===e.defenders.length:0===e.attackers.length,r.style.backgroundColor=n||"",r.style.opacity="1";const u=document.createElement("div");u.classList.add("attackers-defenders");const p=document.createElement("p");if(p.style.fontSize="12px",u.style.padding="2px",p.innerText=""+(e.defenders.length-e.attackers.length),u.appendChild(p),r.style.outline="1px solid black",f){const e=(0,a.U)();r.appendChild(e)}else if("null"!==l?.winner&&l.diff>0){const e=(0,i.q)(d,l);r.appendChild(e)}const h=(0,c.U)(e);r.appendChild(h),r.appendChild(u)}}))}if(r){const e=r.split(" ").join("."),t=document.querySelector(`.${e}`);if(t){const e=t?.querySelectorAll(".attackers-defenders");e?.forEach((e=>{t?.removeChild(e)})),t.style.backgroundColor="transparent"}}}const b=new MutationObserver((e=>{e.forEach((e=>{if("attributes"===e.type&&"class"===e.attributeName){const t=e.target;t.classList.contains("piece")&&!t.classList.contains("dragging")&&function(e){const t=u&&u.childNodes;if(!t)return;const r=Array.from(t).filter((e=>e.nodeType===Node.ELEMENT_NODE&&e.classList.contains("piece"))).map((e=>{const t=e;return`${t.classList[1]}_${t.classList[2]}`})).join("_");(0,n.B)(p,r).trim()&&(p=r,h(e))}(t.classList.value)}}))}));u&&u.childNodes&&u.childNodes.forEach((e=>{b.observe(e,{attributes:!0,attributeFilter:["class"]})}))})()})();